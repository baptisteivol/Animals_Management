AJOUT CLÉ SSH PUBLIC - CONNEXION SUR SERVEUR DEPUIS ORMUCO
 
Commande depuis ma machine : 
ssh -i "bivol_AWS.pem" ubuntu@ec2-3-18-113-187.us-east-2.compute.amazonaws.com "echo $(cat ~/.ssh/bivol.pub) >> .ssh/authorized_keys"


AJOUT UTILISATEUR (bivol/bivol)

sudo adduser bivol
sudo usermod -aG sudo bivol
su - bivol


AUTORISATION SSH USER

sudo nano /etc/ssh/sshd_config
PasswordAuthentication no to PasswordAuthentication yes
sudo service ssh restart


INSTALLATION NODE SERVER

https://tecadmin.net/install-latest-nodejs-npm-on-ubuntu/

TEST : TUNEL SSH
Tué tout ce qui écoute sur le port 3000 : lsof -ti:3000 | xargs kill -9
Tunnel : ssh -f 3.18.113.187 -L 3000:localhost:3000 -N
Tue tout les tunnel : pkill ssh


INSTALLATION NGINX FRONTEND

https://tecadmin.net/setup-nginx-as-frontend-server-for-nodejs/


KILL NODE

ps aux | grep node
kill -9 PID


LANCER APP

node myapp.js &


CONF VIRTUALHOST (REDIRECTION VERS MYAPP)

cat /etc/nginx/sites-enabled/default 
server {
    listen 80;

    server_name 3.18.113.187;

    location / {
        proxy_pass http://127.0.0.1:3000;
        proxy_http_version 1.1;
        proxy_set_header Upgrade $http_upgrade;
        proxy_set_header Connection 'upgrade';
        proxy_set_header Host $host;
        proxy_cache_bypass $http_upgrade;
    }
}


https://dev.to/achowba/build-a-simple-app-using-node-js-and-mysql-19me

sudo apt install mysql-server
sudo mysql

CREATE DATABASE favorite_animals;

use favorite_animals

CREATE TABLE IF NOT EXISTS `animals` (
  `name` varchar(255) NOT NULL,
  `favorite_color` varchar(255) NOT NULL,
  `type` varchar(255) NOT NULL,
  PRIMARY KEY (`name`)
) ENGINE=InnoDB  DEFAULT CHARSET=latin1 AUTO_INCREMENT=1;


ADD ANIMAL

<% include partials/header.ejs %>
    <div class="container">
        <% if (message != '') { %>
            <p class="text-center text-danger"><%= message %></p>
        <% } %>
        <form class="add-animal-form" action="" method="post" enctype="multipart/form-data">
            <div class="form-row">
                <div class="form-group col-md-4">
                    <input type="text" class="form-control" name="name" id="name" placeholder="Name" required>
                </div>
            </div>
            <div class="form-row">
                <div class="form-group col-md-6">
                    <input type="text" class="form-control" name="favorite_color" id="favorite_color" placeholder="Favorite Color" required>
                </div>
                <div class="form-group col-md-6">
                    <select id="type" name="type" class="form-control" required>
                        <option selected disabled>Choose position</option>
                        <option>Dogs</option>
                        <option>Cat</option>
                    </select>
                </div>
            </div>
            <button type="submit" class="btn btn-primary float-right">Add Player</button>
        </form>
    </div>
</div>
</body>
</html>

https://www.mbejda.com/deploying-node-applications-with-ansible/



